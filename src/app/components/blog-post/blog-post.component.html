<article class="w-full flex flex-col items-center">
	<div>
		@if (blogPost) {
		<div class="blog-post container w-full flex flex-col gap-6">
			<p-divider>
				<h2 class="text-center">{{ blogPost.title }}</h2>
			</p-divider>
			<div class="self-center">
				<!-- FULL IMG -->
				<p-image
					[src]="blogPost.image"
					[alt]="blogPost.title"
					[preview]="true"
					class=""
				>
					<ng-template pTemplate="indicator">
						<i class="pi pi-search"></i>
					</ng-template>
					<ng-template pTemplate="image">
						<!-- PREVIEW IMG -->
						<img
							[src]="blogPost.image"
							[alt]="blogPost.title"
							width="350"
							class="rounded-md overflow-hidden"
						/>
					</ng-template>
					<ng-template
						pTemplate="preview"
						let-style="style"
						let-previewCallback="previewCallback"
					>
						<div class="m-auto flex justify-center">
							<img
								[src]="blogPost.image"
								[alt]="blogPost.title"
								[style]="style"
								(click)="previewCallback()"
								class="max-w-[80%]"
							/>
						</div>
					</ng-template>
				</p-image>
			</div>
			<p
				class="max-w-[60ch] md:max-w-[75ch] leading-relaxed break-words hyphens-auto text-pretty"
				[innerHTML]="blogPost.content"
			></p>
			<div
				class="post-footer flex flex-col justify-start gap-4 text-muted-color"
			>
				<p>Author: {{ blogPost.author }}</p>
				<p class="text-muted-color">{{ blogPost.date | date }}</p>
				<p-button
					[rounded]="true"
					styleClass="min-w-[68px] flex gap-2"
					[raised]="true"
					[label]="blogPost.likes.toString()"
					(click)="toggleLike()"
				>
					<i
						class="pi"
						[class.pi-heart-fill]="blogPost.likedByUser"
						[class.pi-heart]="!blogPost.likedByUser"
						[class.animated]="likeToggled"
						(animationend)="resetAnimation()"
					></i>
				</p-button>
			</div>
			<p-card styleClass="py-4 px-2">
				<form
					[formGroup]="commentForm"
					(ngSubmit)="saveComment(this.blogPost.id)"
					class="flex flex-col gap-4"
				>
					<p-inputgroup>
						<p-inputgroup-addon>
							<i class="pi pi-user"></i>
						</p-inputgroup-addon>
						<p-floatlabel variant="over">
							<label for="author">Name</label>
							<input
								pInputText
								id="author"
								formControlName="author"
								type="text"
								class="w-full"
							/>
						</p-floatlabel>
					</p-inputgroup>
					<p-inputgroup class="mt-4 flex flex-col">
						<p-floatlabel>
							<label for="content">Comment:</label>
							<textarea
								pTextarea
								id="content"
								name="content"
								rows="4"
								cols="30"
								[autoResize]="true"
								formControlName="content"
								type="textarea"
								maxlength="300"
								class="w-full h-24"
							></textarea>
						</p-floatlabel>
					</p-inputgroup>
					<p-button type="submit" icon="pi pi-send" label="send" />
				</form>
			</p-card>
			<p-divider>Comments:</p-divider>

			@for (comment of comments; track $index) {
			<!-- <p-card> -->
			<p-fieldset styleClass="max-w-[80%]">
				<ng-template #header>
					<div class="flex items-center gap-3 px-1">
						<p-avatar class="" icon="pi pi-user" shape="circle" />
						<span class="font-bold">{{ comment.author | ellipsis : 40 }}</span>
					</div>
				</ng-template>
				<p class="m-6 mt-2">
					{{comment.content}}
				</p>
				<i class="text-muted-color text-sm">{{comment.date | date:'MM-d-y, H:mm' }}</i>
			</p-fieldset>
			<!-- </p-card> -->
			}
		</div>
		} @else {
		{{ notFound }}
		}
		<ng-template #notFound>
			<p>Blog post not found...</p>
		</ng-template>
	</div>
</article>
